{{/* Get the base link */}}
{{ $link := .Get "link" }}

{{/* Automatically append affiliate tag if affiliate="true" and link is not internal */}}
{{ if and (.Get "affiliate") (ne $link "#") (not (strings.HasPrefix $link "/")) }}
{{ $tag := site.Params.affiliate.amazon | default "savemybonsai-20" }}
{{ if not (strings.Contains $link "tag=") }}
{{ if strings.Contains $link "?" }}
{{ $link = (print $link "&tag=" $tag) }}
{{ else }}
{{ $link = (print $link "?tag=" $tag) }}
{{ end }}
{{ end }}
{{ end }}
<h3 class="text-2xl font-serif font-bold text-bonsai-900 leading-tight">{{ .Get "name" }}</h3>
<span class="text-xl font-bold text-gold-600 whitespace-nowrap ml-6 font-serif">{{ .Get "price" }}</span>
</div>

<div class="flex items-center gap-2 mb-4">
  <div class="text-xs text-gold-500 tracking-widest uppercase font-bold">Editor's Choice</div>
  <span class="text-bonsai-300">|</span>
  <div class="text-xs text-bonsai-500">{{ .Get "rating" }}</div>
</div>

<p class="text-bonsai-600 text-sm leading-relaxed mb-8 flex-grow border-t border-bonsai-100 pt-4">{{ .Get
  "description" }}</p>

<div class="flex flex-col sm:flex-row gap-4 items-center mt-auto">
  <a href="{{ $link }}" class="btn btn-primary w-full sm:w-auto text-xs" target="_blank" rel="noopener noreferrer">
    {{ .Get "cta" | default "View on Amazon" }}
  </a>
  {{ if and (.Get "affiliate") (ne (.Get "link") "#") }}
  <span class="text-[10px] text-bonsai-400 uppercase tracking-wider">
    *Commission Earned
  </span>
  {{ end }}
</div>
</div>
</div>